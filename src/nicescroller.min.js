(function(h){function t(a,b){var c={};c[w+"transform"]="translate3d("+a+"px, "+b+"px, 0px)";this.jScrollBox.css(c);this.current={x:a,y:b};this.cfg.scrollbar&&I.apply(this)}function I(){var a=this.current,b={},c=this.wrapperSize,d=0,q=this.dir,e=this.barSize;1!==q&&(d=a.x/this.maxScrollWidth*(c.width-e.x),b[w+"transform"]="translate3d("+d+"px, 0px, 0px)",this.jBarX.css(b));0!==q&&(d=a.y/this.maxScrollHeight*(c.height-e.y),b[w+"transform"]="translate3d(0px, "+d+"px, 0px)",this.jBarY.css(b))}function x(a){function b(){d=
+new Date-c;r[k.cfg.animation]?(e=r[k.cfg.animation](d,l,m,g),f=r[k.cfg.animation](d,h,n,g)):(e=r.linear(d,l,m,g),f=r.linear(d,h,n,g));if(d>=g)e=a.x,f=a.y,t.call(k,e,f),k.jBox.removeClass("active"),k.cfg.onscrollend&&k.cfg.onscrollend.apply(k);else{t.call(k,e,f);var p=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||setTimeout)(b);k.timer=p}}var c=+new Date,d=0,e,f,g=a.duration,l=this.current.x,h=this.current.y,m=a.x-
l,n=a.y-h,k=this;b()}function p(){this.timer&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||clearTimeout)(this.timer)}function J(a){if(!this.cfg.ontouchstart||this.cfg.ontouchstart.apply(this)){p.apply(this);this.touched=!0;y.push(this);l=m=C(a);a=this.dir;var b=this.point,c=this.current;b.x=1===a?0:c.x;b.y=0===a?0:c.y;D=+new Date}}function E(a){if((e=y[0])&&e.touched){e.jBox.addClass("active");l=C(a);var b=e.dir,c=e.point;
K.call(e,1===b?0:c.x+l.x-m.x,0===b?0:c.y+l.y-m.y);a.preventDefault()}}function F(a){if(e){e.touched=!1;var b=l.x-m.x,c=l.y-m.y,d=e.point,q=e.cfg.deceleration,f=e.wrapperSize,g=e.dir;a=e.maxScrollWidth;var h=e.maxScrollHeight;if(0!==b||0!==c)z=+new Date-D,e.cfg.momentum&&(b=1===g?{duration:0,destination:0}:G(d.x,d.x+b,z,e.maxScrollWidth,f.width,q),c=0===g?{duration:0,destination:0}:G(d.y,d.y+c,z,e.maxScrollHeight,f.height,q),d=Math.max(b.duration,c.duration),b.destination=0<b.destination?0:b.destination<
a?a:b.destination,c.destination=0<c.destination?0:c.destination<h?h:c.destination,e.scrollTo(b.destination,c.destination,d)),e.cfg.ontouchend&&e.cfg.ontouchend.apply(e),e=null,y=[]}}function G(a,b,c,d,e,f){b-=a;c=Math.abs(b)/c;var g;g=a+c*c/(2*f)*(0>b?-1:1);f=c/f;g<d?(g=e?d-e/2.5*(c/8):d,b=Math.abs(g-a),f=b/c):0<g&&(g=e?e/2.5*(c/8):0,b=Math.abs(a)+g,f=b/c);return{destination:Math.round(g),duration:f}}function K(a,b){t.call(this,a,b)}function L(){var a=this;this.jScrollBox.on(n.start,function(b){J.call(a,
b)});A||(h(document).on(n.move,E).on(n.end,F),A=!0)}function H(){var a,b,c,d,e,f;this.jScrollBox=this.jBox.children().eq(0);d={width:this.jBox.width(),height:this.jBox.height()};a=d.width-this.jScrollBox.width();b=d.height-this.jScrollBox.height();e=this.cfg.x||0;f=this.cfg.y||0;c=0>a?0>b?2:0:0>b?1:-1;-1!==c&&(this.dir=c,this.maxScrollWidth=a,this.maxScrollHeight=b,this.wrapperSize=d,this.point={x:e,y:f},this.cfg.scrollbar&&(this.jBox.append('<div class="scrollbar-x scrollbar"><div class="bar"></div></div><div class="scrollbar-y scrollbar"><div class="bar"></div></div>'),
this.jScrollBarX=this.jBox.find(".scrollbar-x"),this.jScrollBarY=this.jBox.find(".scrollbar-y"),this.barSize={x:d.width/-a*d.width,y:d.height/-b*d.height},this.jBarX=this.jScrollBarX.find(".bar").width(this.barSize.x),this.jBarY=this.jScrollBarY.find(".bar").height(this.barSize.y),0===c&&this.jScrollBarY.remove(),1===c&&this.jScrollBarX.remove()),L.apply(this),u++,t.call(this,e,f))}function v(a,b){this.jBox=h(a);this.cfg=h.extend({},M,b);H.apply(this);return this}var B="ontouchend"in document,n={click:"click",
start:B?"touchstart":"mousedown",move:B?"touchmove":"mousemove",end:B?"touchend":"mouseup"},w=function(){var a=document.createElement("div").style,b=["WebkitT","MozT","MsT"],c="",d=0,e="";for(d;3>d;d++)if(c=b[d],"undefined"!==typeof a[c+"ransform"]){e="-"+c.replace("T","").toLowerCase()+"-";break}return e}(),r={"ease-out-back":function(a,b,c,d){return c*((a=a/d-1)*a*(2.70158*a+1.70158)+1)+b},"ease-out":function(a,b,c,d){return-c*(a/=d)*(a-2)+b},linear:function(a,b,c,d){return a/d*c+b}},M={scrollbar:!0,
momentum:!0,animation:"ease-out",deceleration:6E-4},e=null,y=[],m={},l={},D,z,A=!1,u=0,C=function(a){a=a.originalEvent?a.originalEvent:a;var b=a.touches,c=0,d=0;b?(c=b[0].pageX,d=b[0].pageY):(c=a.clientX,d=a.clientY);return{x:c,y:d}};v.prototype={scrollTo:function(a,b,c){p.apply(this);x.call(this,{duration:c,x:a,y:b});this.jBox.addClass("active");return this},scrollXTo:function(a,b){p.apply(this);x.call(this,{duration:b,x:a,y:this.current.y});this.jBox.addClass("active");return this},scrollYTo:function(a,
b){p.apply(this);x.call(this,{duration:b,x:this.current.x,y:a});this.jBox.addClass("active");return this},refresh:function(a){var b=this.current.x,c=this.current.y;u--;this.jBox.find(".scrollbar").remove();this.cfg=h.extend(this.cfg,{x:b,y:c},a);H.apply(this);return this},destroy:function(){var a="";this.jBox.removeClass("active").off().find(".scrollbar").remove();for(a in this)delete this[a];this.__proto__=null;u--;0===u&&(h(document).off(n.move,E).off(n.end,F),A=!1)}};"function"===typeof define&&
define.amd?define([],function(){return v}):"undefined"!==typeof module&&module.exports?module.exports=v:window.NiceScroller=v})(window.jQuery||window.Zepto);